!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("axios")):"function"==typeof define&&define.amd?define(["exports","axios"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).HengRequest={},e.axios)}(this,(function(e,n){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=t(n),s=function(){function e(e){var n,t,s,i,l,r,u=this;this.loadingCount=0,this.DEFAULT_LOADING=!0,this.DEFAULT_MESSAGE=!0,this.instance=o.default.create(e),this.interceptors=e.interceptors,this.showLoading=null!==(n=e.showLoading)&&void 0!==n?n:this.DEFAULT_LOADING,this.showResponseMessage=null!==(t=e.showResponseMessage)&&void 0!==t?t:this.DEFAULT_MESSAGE,this.cancleRequests=e.cancleRequests,this.handleCallback=e.handleCallback,this.instance.interceptors.request.use(null===(s=this.interceptors)||void 0===s?void 0:s.requestInterceptor,null===(i=this.interceptors)||void 0===i?void 0:i.requestInterceptorCatch),this.instance.interceptors.response.use(null===(l=this.interceptors)||void 0===l?void 0:l.responseInterceptor,null===(r=this.interceptors)||void 0===r?void 0:r.responseInterceptorCatch),this.instance.interceptors.request.use((function(e){var n,t,o;return(null!==(n=e.showLoading)&&void 0!==n?n:u.showLoading)&&(u.loadingCount++,null===(o=null===(t=u.handleCallback)||void 0===t?void 0:t.loadingStart)||void 0===o||o.call(t)),e}),(function(e){return Promise.reject(e)})),this.instance.interceptors.response.use((function(e){return e.data}),(function(e){return Promise.reject(e)}))}return e.prototype.request=function(e){var n=this;return new Promise((function(t,s){var i;(null===(i=e.interceptors)||void 0===i?void 0:i.requestInterceptor)&&(e=e.interceptors.requestInterceptor(e));var l=e.url;l&&(e.cancelToken=new o.default.CancelToken((function(e){var t,o;null===(o=n.cancleRequests)||void 0===o||o.push(((t={})[l]=e,t))}))),n.instance.request(e).then((function(o){var s,i,l,r,u,c,a;(null===(s=e.interceptors)||void 0===s?void 0:s.responseInterceptor)&&(o=e.interceptors.responseInterceptor(o)),(null!==(i=e.showResponseMessage)&&void 0!==i?i:n.showResponseMessage)&&(null===(r=null===(l=n.handleCallback)||void 0===l?void 0:l.response)||void 0===r||r.call(l)),(null!==(u=e.showLoading)&&void 0!==u?u:n.showLoading)&&0==--n.loadingCount&&(null===(a=null===(c=n.handleCallback)||void 0===c?void 0:c.loadingEnd)||void 0===a||a.call(c)),t(o)})).catch((function(t){var o,i,l,r,u,c;(null!==(o=e.showResponseMessage)&&void 0!==o?o:n.showResponseMessage)&&(null===(l=null===(i=n.handleCallback)||void 0===i?void 0:i.responseErr)||void 0===l||l.call(i,t)),(null!==(r=e.showLoading)&&void 0!==r?r:n.showLoading)&&0==--n.loadingCount&&(null===(c=null===(u=n.handleCallback)||void 0===u?void 0:u.loadingEnd)||void 0===c||c.call(u)),s(t)})).finally((function(){l&&n.deleteUrl(l)}))}))},e.prototype.getRequestIndex=function(e){var n;return null===(n=this.cancleRequests)||void 0===n?void 0:n.findIndex((function(n){return Object.keys(n)[0]===e}))},e.prototype.deleteUrl=function(e){var n,t=this.getRequestIndex(e);-1!==t&&(null===(n=this.cancleRequests)||void 0===n||n.splice(t,1))},e.prototype.cancelAllRequest=function(){var e;null===(e=this.cancleRequests)||void 0===e||e.forEach((function(e){e[Object.keys(e)[0]]()}))},e.prototype.cancelRequest=function(e){var n,t=this;if("string"==typeof e){var o=this.getRequestIndex(e);-1!==o&&(null===(n=this.cancleRequests)||void 0===n||n[o][e]())}else e.forEach((function(e){var n,o=t.getRequestIndex(e);-1!==o&&(null===(n=t.cancleRequests)||void 0===n||n[o][e]())}))},e}();e.HttpRequest=s,Object.defineProperty(e,"__esModule",{value:!0})}));
